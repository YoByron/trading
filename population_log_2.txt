2025-11-26 16:34:48,787 - src.utils.market_data - INFO - ✅ Alpaca API initialized as PRIMARY market data source (most reliable)
2025-11-26 16:34:48,788 - src.utils.market_data - INFO - ✅ Polygon.io API available as secondary market data source
2025-11-26 16:34:48,788 - src.utils.market_data - INFO - MarketDataProvider configuration (RELIABLE FIRST):
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -   - Alpaca API: ✅ enabled (PRIMARY - most reliable)
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -   - Polygon.io: ✅ enabled (SECONDARY - reliable paid)
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -     * Polygon retries: 3, backoff: 30s (exponential), max_data_age: 48h
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -   - Cache: dir=data/cache/alpha_vantage, ttl=21600s, max_age=7d (FAST FALLBACK)
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -   - yfinance: max_retries=3 (UNRELIABLE FREE - last resort)
2025-11-26 16:34:48,788 - src.utils.market_data - INFO -   - Alpha Vantage: disabled (SLOW RATE-LIMITED - avoid)
2025-11-26 16:34:48,788 - src.utils.data_collector - INFO - DataCollector initialized: data/historical
2025-11-26 16:34:48,788 - src.utils.data_collector - INFO - Collecting data for 4 symbols with 252 days lookback
2025-11-26 16:34:48,788 - src.utils.data_collector - INFO - Fetching data for SPY...
2025-11-26 16:34:48,789 - src.utils.market_data - INFO - SPY: Fetching from Polygon.io API (primary reliable source)
2025-11-26 16:34:49,139 - src.utils.market_data - INFO - SPY: Successfully fetched 120 bars from Polygon.io
2025-11-26 16:34:49,141 - src.utils.market_data - WARNING - SPY: Polygon.io returned insufficient data, trying Alpaca
2025-11-26 16:34:49,142 - src.utils.market_data - INFO - SPY: Fetching from Alpaca API (secondary reliable source)
2025-11-26 16:34:49,383 - src.utils.market_data - INFO - SPY: Successfully fetched 1 bars from Alpaca API
2025-11-26 16:34:49,384 - src.utils.market_data - WARNING - SPY: Alpaca API returned insufficient data, trying cache/yfinance
2025-11-26 16:34:49,392 - src.utils.market_data - WARNING - SPY: Paid sources unavailable/unreliable. Trying yfinance (unreliable free source).
2025-11-26 16:34:50,387 - src.utils.market_data - WARNING - SPY: Alpha Vantage fallback unavailable (ALPHA_VANTAGE_API_KEY not configured).
2025-11-26 16:34:50,387 - src.utils.market_data - WARNING - SPY: All live data sources failed. Attempting to use cached data.
2025-11-26 16:34:50,388 - src.utils.data_collector - ERROR - Error collecting data for SPY: Failed to fetch 252 days of data for SPY from all sources:

2025-11-26 16:34:50,388 - src.utils.data_collector - INFO - Fetching data for QQQ...
2025-11-26 16:34:50,388 - src.utils.market_data - INFO - QQQ: Fetching from Polygon.io API (primary reliable source)
2025-11-26 16:34:50,479 - src.utils.market_data - INFO - QQQ: Successfully fetched 120 bars from Polygon.io
2025-11-26 16:34:50,482 - src.utils.market_data - WARNING - QQQ: Polygon.io returned insufficient data, trying Alpaca
2025-11-26 16:34:50,482 - src.utils.market_data - INFO - QQQ: Fetching from Alpaca API (secondary reliable source)
2025-11-26 16:34:50,542 - src.utils.market_data - INFO - QQQ: Successfully fetched 1 bars from Alpaca API
2025-11-26 16:34:50,542 - src.utils.market_data - WARNING - QQQ: Alpaca API returned insufficient data, trying cache/yfinance
2025-11-26 16:34:50,545 - src.utils.market_data - WARNING - QQQ: Paid sources unavailable/unreliable. Trying yfinance (unreliable free source).
2025-11-26 16:34:51,771 - src.utils.market_data - WARNING - QQQ: Alpha Vantage fallback unavailable (ALPHA_VANTAGE_API_KEY not configured).
2025-11-26 16:34:51,771 - src.utils.market_data - WARNING - QQQ: All live data sources failed. Attempting to use cached data.
2025-11-26 16:34:51,773 - src.utils.data_collector - ERROR - Error collecting data for QQQ: Failed to fetch 252 days of data for QQQ from all sources:

2025-11-26 16:34:51,773 - src.utils.data_collector - INFO - Fetching data for VOO...
2025-11-26 16:34:51,773 - src.utils.market_data - INFO - VOO: Fetching from Polygon.io API (primary reliable source)
2025-11-26 16:34:51,865 - src.utils.market_data - INFO - VOO: Successfully fetched 120 bars from Polygon.io
2025-11-26 16:34:51,872 - src.utils.market_data - WARNING - VOO: Polygon.io returned insufficient data, trying Alpaca
2025-11-26 16:34:51,872 - src.utils.market_data - INFO - VOO: Fetching from Alpaca API (secondary reliable source)
2025-11-26 16:34:51,924 - src.utils.market_data - INFO - VOO: Successfully fetched 1 bars from Alpaca API
2025-11-26 16:34:51,925 - src.utils.market_data - WARNING - VOO: Alpaca API returned insufficient data, trying cache/yfinance
2025-11-26 16:34:51,928 - src.utils.market_data - WARNING - VOO: Paid sources unavailable/unreliable. Trying yfinance (unreliable free source).
2025-11-26 16:34:53,036 - src.utils.market_data - WARNING - VOO: Alpha Vantage fallback unavailable (ALPHA_VANTAGE_API_KEY not configured).
2025-11-26 16:34:53,036 - src.utils.market_data - WARNING - VOO: All live data sources failed. Attempting to use cached data.
2025-11-26 16:34:53,037 - src.utils.data_collector - ERROR - Error collecting data for VOO: Failed to fetch 252 days of data for VOO from all sources:

2025-11-26 16:34:53,037 - src.utils.data_collector - INFO - Fetching data for BND...
2025-11-26 16:34:53,037 - src.utils.market_data - INFO - BND: Fetching from Polygon.io API (primary reliable source)
2025-11-26 16:34:53,152 - src.utils.market_data - INFO - BND: Successfully fetched 120 bars from Polygon.io
2025-11-26 16:34:53,156 - src.utils.market_data - WARNING - BND: Polygon.io returned insufficient data, trying Alpaca
2025-11-26 16:34:53,156 - src.utils.market_data - INFO - BND: Fetching from Alpaca API (secondary reliable source)
2025-11-26 16:34:53,213 - src.utils.market_data - INFO - BND: Successfully fetched 1 bars from Alpaca API
2025-11-26 16:34:53,214 - src.utils.market_data - WARNING - BND: Alpaca API returned insufficient data, trying cache/yfinance
2025-11-26 16:34:53,217 - src.utils.market_data - WARNING - BND: Paid sources unavailable/unreliable. Trying yfinance (unreliable free source).
2025-11-26 16:34:53,894 - src.utils.market_data - WARNING - BND: Alpha Vantage fallback unavailable (ALPHA_VANTAGE_API_KEY not configured).
2025-11-26 16:34:53,894 - src.utils.market_data - WARNING - BND: All live data sources failed. Attempting to use cached data.
2025-11-26 16:34:53,895 - src.utils.data_collector - ERROR - Error collecting data for BND: Failed to fetch 252 days of data for BND from all sources:

/Users/igorganapolsky/workspace/git/apps/trading/src/utils/data_collector.py:122: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(file, index_col=0, parse_dates=True)
2025-11-26 16:34:53,897 - src.utils.data_collector - INFO - Loaded 34 rows for SPY from 1 files
/Users/igorganapolsky/workspace/git/apps/trading/src/utils/data_collector.py:122: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(file, index_col=0, parse_dates=True)
2025-11-26 16:34:53,898 - src.utils.data_collector - INFO - Loaded 34 rows for QQQ from 1 files
/Users/igorganapolsky/workspace/git/apps/trading/src/utils/data_collector.py:122: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(file, index_col=0, parse_dates=True)
2025-11-26 16:34:53,899 - src.utils.data_collector - INFO - Loaded 27 rows for VOO from 1 files
======================================================================
Historical Data Collection for Backtesting
======================================================================

Collecting data for symbols: SPY, QQQ, VOO, BND
Lookback period: 252 days (1 year of trading data)

Note: This requires API keys to be configured.
See docs/ENVIRONMENT_VARIABLES.md for setup instructions.


======================================================================
Data collection complete!
======================================================================

Collected files:
  SPY: 34 rows (latest: SPY_2025-11-02.csv)
  QQQ: 34 rows (latest: QQQ_2025-11-02.csv)
  VOO: 27 rows (latest: VOO_2025-11-02.csv)
  BND: No files found (check API keys)

To verify data quality:
  python src/utils/data_collector.py --load SPY
