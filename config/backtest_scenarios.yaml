defaults:
  description: "Daily DCA momentum strategy stress tests"
  initial_capital: 100000
  daily_allocation: 10.0
  etf_universe: ["SPY", "QQQ", "VOO"]
  use_vca: false
  lookback_buffer_days: 200
  tags:
    - r_and_d_phase
    - promotion_gate

scenarios:
  - name: bull_run_2024
    label: "Bullish melt-up (Jan-Mar 2024)"
    start_date: "2024-01-02"
    end_date: "2024-03-29"
    description: >
      Tests performance when SPY/QQQ melt upward. Ensures system
      captures upside without blowing risk allocations.

  - name: inflation_shock_2022
    label: "Inflation drawdown (Apr-Jun 2022)"
    start_date: "2022-04-01"
    end_date: "2022-06-30"
    description: >
      Simulates a fast drawdown + chop regime to validate drawdown control,
      ATR sizing, and halt triggers.

  - name: sideways_chop_2023
    label: "Sideways consolidation (Jul-Sep 2023)"
    start_date: "2023-07-01"
    end_date: "2023-09-30"
    etf_universe: ["SPY", "QQQ", "VOO"]
    daily_allocation: 10.0
    description: >
      Tests performance during low-trend, choppy sideways market.
      Validates that momentum filters correctly reject false signals
      and avoids over-trading during range-bound conditions.
      Critical for proving the system doesn't lose money in neutral markets.

  - name: covid_whiplash_2020
    label: "High-volatility crash/rebound (Feb-May 2020)"
    start_date: "2020-02-03"
    end_date: "2020-05-29"
    daily_allocation: 15.0
    description: >
      Stress test for historic volatility spike. Ensures ATR sizing and
      guardrails throttle exposure before we allow live promotion.

  - name: weekend_proxy_2023
    label: "Closed-market coverage (Bond proxy)"
    start_date: "2023-06-01"
    end_date: "2023-09-04"
    etf_universe: ["TLT", "SHY"]
    description: >
      Validates weekend/holiday coverage by routing the funnel through
      treasury ETFs. Ensures thresholds and sizing logic remain
      stable when traditional equity markets are unavailable.

  - name: holiday_regime_2024
    label: "Holiday/Weekend regime (TLT + Equities)"
    start_date: "2024-01-01"
    end_date: "2024-12-31"
    etf_universe: ["SPY", "TLT"]
    daily_allocation: 10.0
    max_trades_per_day: 2
    description: >
      Tests full-year holiday/weekend trading with treasury flight-to-safety (TLT)
      and equity exposure. Validates regime detection switches during off-hours sessions.

  - name: high_vol_2022_q4
    label: "High volatility regime (Oct-Dec 2022)"
    start_date: "2022-10-01"
    end_date: "2022-12-30"
    etf_universe: ["SPY", "QQQ", "TLT"]
    daily_allocation: 8.0
    description: >
      Tests performance during elevated VIX and rate hike uncertainty.
      Validates vol-scaled slippage and treasury allocation during stress.

  # Bond-Specific Scenarios
  - name: bond_bull_2020
    label: "Treasury bull run (Mar-Aug 2020)"
    start_date: "2020-03-01"
    end_date: "2020-08-31"
    etf_universe: ["TLT", "IEF", "SHY", "BND"]
    daily_allocation: 10.0
    description: >
      Tests treasury ladder performance during flight-to-safety rally.
      Validates duration rotation and yield curve strategy during crisis.

  - name: bond_bear_2022
    label: "Treasury crash (Jan-Oct 2022)"
    start_date: "2022-01-03"
    end_date: "2022-10-31"
    etf_universe: ["TLT", "IEF", "SHY", "LQD", "JNK"]
    daily_allocation: 10.0
    description: >
      Stress test for worst bond market in 40 years (rate hikes).
      Validates duration-adjusted stops and short-duration rotation.

  - name: yield_curve_inversion_2023
    label: "Yield curve inversion regime (Jan-Dec 2023)"
    start_date: "2023-01-01"
    end_date: "2023-12-29"
    etf_universe: ["SHY", "IEF", "TLT"]
    daily_allocation: 10.0
    description: >
      Tests yield curve strategy during sustained inversion.
      Validates short-duration preference and ladder rebalancing.

  - name: credit_stress_2020
    label: "Credit spread blowout (Feb-Apr 2020)"
    start_date: "2020-02-01"
    end_date: "2020-04-30"
    etf_universe: ["LQD", "JNK", "HYG", "TLT"]
    daily_allocation: 10.0
    description: >
      Tests corporate bond risk management during credit stress.
      Validates high-yield limits and flight-to-quality rotation.

  - name: bond_steepener_2021
    label: "Yield curve steepening (Jan-Mar 2021)"
    start_date: "2021-01-01"
    end_date: "2021-03-31"
    etf_universe: ["SHY", "TLT", "IEF"]
    daily_allocation: 10.0
    description: >
      Tests barbell strategy during curve steepening.
      Validates long-duration allocation during bullish steepener.

  - name: mixed_asset_2024
    label: "Mixed equity/bond allocation (Jan-Jun 2024)"
    start_date: "2024-01-02"
    end_date: "2024-06-28"
    etf_universe: ["SPY", "QQQ", "TLT", "SHY", "LQD"]
    daily_allocation: 10.0
    description: >
      Tests 60/40-style mixed allocation with bond ladder.
      Validates correlation benefits and rebalancing triggers.
  - name: theta_scale_2025
    label: "Theta scaling unlock (Sep-Oct 2025)"
    start_date: "2025-09-01"
    end_date: "2025-10-31"
    daily_allocation: 12.0
    description: >
      60-day verification window for the theta automation layer after the
      fundamentals cache + execution tie-in. Validates that IV-gated covered
      calls hold a 26% annualized pace with drawdowns capped near 2%.

  # ============================================================
  # CRASH REPLAY SCENARIOS (CEO directive Dec 12, 2025)
  # Survival gate: >95% capital preservation required
  # ============================================================

  - name: crash_2008_lehman
    label: "2008 Financial Crisis - Lehman collapse (Sep-Nov 2008)"
    start_date: "2008-09-01"
    end_date: "2008-11-30"
    etf_universe: ["SPY", "QQQ", "TLT", "SHY"]
    daily_allocation: 10.0
    max_trades_per_day: 1
    survival_gate: 0.95
    description: >
      CEO DIRECTIVE: Bear-proof the system. Replay 2008 Lehman collapse.
      Requires >95% capital survival (max 5% drawdown allowed).
      Tests flight-to-safety rotation (SPYâ†’TLT/SHY) during credit crisis.
      If system loses >5%, it fails promotion gate.

  - name: crash_2008_bottom
    label: "2008 Financial Crisis - Bear market bottom (Jan-Mar 2009)"
    start_date: "2009-01-01"
    end_date: "2009-03-31"
    etf_universe: ["SPY", "QQQ", "TLT"]
    daily_allocation: 10.0
    max_trades_per_day: 1
    survival_gate: 0.95
    description: >
      Replay the absolute bottom of 2008-2009 bear market.
      SPY hit $67.10 on March 9, 2009 (down 57% from peak).
      Tests: Can system survive capitulation without >5% loss?
      Must prove drawdown controls work at maximum fear.

  - name: crash_2020_covid_march
    label: "2020 COVID Crash - Fastest bear market (Feb 19 - Mar 23, 2020)"
    start_date: "2020-02-19"
    end_date: "2020-03-23"
    etf_universe: ["SPY", "QQQ", "VOO"]
    daily_allocation: 10.0
    max_trades_per_day: 1
    survival_gate: 0.95
    description: >
      CEO DIRECTIVE: Bear-proof the system. Replay COVID crash.
      SPY dropped 34% in 23 trading days - fastest bear ever.
      VIX hit 82.69 on March 16, 2020.
      Survival requirement: >95% capital (max 5% drawdown).
      Tests ATR scaling, circuit breakers, and halt logic under historic vol.

  - name: crash_2020_recovery
    label: "2020 COVID Recovery - V-shaped bounce (Mar-Jun 2020)"
    start_date: "2020-03-23"
    end_date: "2020-06-30"
    etf_universe: ["SPY", "QQQ", "VOO"]
    daily_allocation: 10.0
    max_trades_per_day: 2
    description: >
      Tests ability to capture V-shaped recovery after crash.
      SPY gained 45% from March 23 low to June 30.
      Validates that system doesn't stay too defensive after crash.
      Should capture significant upside while maintaining risk controls.

  - name: crash_2022_fed_tightening
    label: "2022 Fed Tightening Crash (Jan-Oct 2022)"
    start_date: "2022-01-03"
    end_date: "2022-10-12"
    etf_universe: ["SPY", "QQQ", "TLT"]
    daily_allocation: 10.0
    max_trades_per_day: 1
    survival_gate: 0.95
    description: >
      Tests prolonged bear market (not sudden crash).
      SPY down 27%, QQQ down 37%, TLT down 30% (worst bond year in 40 years).
      Validates system behavior when BOTH stocks AND bonds fall.
      No safe haven scenario - pure risk management test.
