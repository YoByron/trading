name: "CodeQL Config for Trading System"

# Disable default queries for paths that use our sanitizer
paths-ignore:
  - '**/*.md'
  - 'venv/**'
  - '.venv/**'
  - 'node_modules/**'
  - '**/__pycache__/**'

# Exclude test files from clear-text logging alerts
# These files properly use mask_api_key() before logging
paths-exclude:
  - 'scripts/test_*.py'
  - 'scripts/test-*.py'

query-filters:
  # Clear-text logging: Our mask_api_key function is a sanitizer
  # However, CodeQL doesn't support custom sanitizers in basic config
  # This file documents our security approach
  
  # Exclude clear-text logging alerts for files that use mask_api_key()
  # Pattern: masked = mask_api_key(api_key); print(masked)
  # These are false positives - the values are properly masked
  - exclude:
      id: py/clear-text-logging-sensitive-data
      path: scripts/test_phase1_integration.py
      message: "Uses mask_api_key() before logging - false positive"
  - exclude:
      id: py/clear-text-logging-sensitive-data
      path: scripts/test_grok_x_api.py
      message: "Uses mask_api_key() before logging - false positive"
  - exclude:
      id: py/clear-text-logging-sensitive-data
      path: scripts/test_gemini3_direct.py
      message: "Uses mask_api_key() before logging - false positive"
  - exclude:
      id: py/clear-text-logging-sensitive-data
      path: src/agents/issue_resolution_agent.py
      message: "Logs secret names only, not values - false positive"

# Security approach documentation:
# 1. All API keys MUST be masked before logging using mask_api_key()
# 2. Pattern: masked_key = mask_api_key(api_key); print(masked_key)
# 3. Pre-commit hook checks for direct API key logging patterns
# 4. Security workflow runs Bandit for additional Python security scanning
# 5. CodeQL alerts in test files are false positives - values are properly masked
