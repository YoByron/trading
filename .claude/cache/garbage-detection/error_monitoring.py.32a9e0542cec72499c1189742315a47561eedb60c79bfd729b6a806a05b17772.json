{
  "dead_imports": [],
  "commented_blocks": [],
  "empty_functions": [],
  "unused_variables": [],
  "all_functions": [
    {
      "name": "init_sentry",
      "line": 17,
      "code": "def init_sentry(dsn: Optional[str]=None) -> bool:\n    \"\"\"\n    Initialize Sentry error monitoring.\n\n    Args:\n        dsn: Sentry DSN (optional, reads from SENTRY_DSN env var)\n\n    Returns:\n        True if initialized successfully, False otherwise\n    \"\"\"\n    global _sentry_initialized\n    if _sentry_initialized:\n        return True\n    dsn = dsn or os.getenv('SENTRY_DSN')\n    if not dsn:\n        logger.debug('Sentry DSN not configured (SENTRY_DSN env var not set)')\n        return False\n    try:\n        import sentry_sdk\n        from sentry_sdk.integrations.logging import LoggingIntegration\n        from sentry_sdk.integrations.requests import RequestsIntegration\n        sentry_sdk.init(dsn=dsn, integrations=[LoggingIntegration(level=logging.INFO, event_level=logging.ERROR), RequestsIntegration()], traces_sample_rate=0.1, profiles_sample_rate=0.1, environment=os.getenv('ENVIRONMENT', 'production'), release=os.getenv('GITHUB_SHA', 'unknown'), before_send=lambda event, hint: _add_trading_context(event, hint))\n        _sentry_initialized = True\n        logger.info('\u2705 Sentry error monitoring initialized')\n        return True\n    except ImportError:\n        logger.warning('sentry-sdk not installed. Install with: pip install sentry-sdk')\n        return False\n    except Exception as e:\n        logger.warning(f'Failed to initialize Sentry: {e}')\n        return False"
    },
    {
      "name": "_add_trading_context",
      "line": 73,
      "code": "def _add_trading_context(event, hint):\n    \"\"\"Add trading-specific context to Sentry events.\"\"\"\n    try:\n        if 'trading' in str(event.get('tags', {})).lower():\n            event.setdefault('tags', {})['component'] = 'trading_system'\n        if os.getenv('GITHUB_ACTIONS'):\n            event.setdefault('tags', {})['workflow'] = os.getenv('GITHUB_WORKFLOW', 'unknown')\n            event.setdefault('tags', {})['run_id'] = os.getenv('GITHUB_RUN_ID', 'unknown')\n            event.setdefault('contexts', {})['github'] = {'workflow': os.getenv('GITHUB_WORKFLOW'), 'run_id': os.getenv('GITHUB_RUN_ID'), 'run_number': os.getenv('GITHUB_RUN_NUMBER')}\n        account_info = _get_account_context()\n        if account_info:\n            event.setdefault('contexts', {})['account'] = account_info\n    except Exception as e:\n        logger.debug(f'Failed to add trading context to Sentry event: {e}')\n    return event"
    },
    {
      "name": "_get_account_context",
      "line": 105,
      "code": "def _get_account_context() -> Optional[dict]:\n    \"\"\"Get account context for Sentry events.\"\"\"\n    try:\n        import json\n        from pathlib import Path\n        state_file = Path('data/system_state.json')\n        if state_file.exists():\n            with open(state_file) as f:\n                state = json.load(f)\n                account = state.get('account', {})\n                return {'equity': account.get('current_equity'), 'pl': account.get('total_pl'), 'pl_pct': account.get('total_pl_pct')}\n    except Exception:\n        pass\n    return None"
    },
    {
      "name": "capture_workflow_failure",
      "line": 126,
      "code": "def capture_workflow_failure(reason: str, context: Optional[dict]=None):\n    \"\"\"Capture workflow failure in Sentry.\"\"\"\n    if not _sentry_initialized:\n        return\n    try:\n        import sentry_sdk\n        with sentry_sdk.push_scope() as scope:\n            scope.set_tag('failure_type', 'workflow')\n            scope.set_level('error')\n            if context:\n                for key, value in context.items():\n                    scope.set_context(key, value)\n            sentry_sdk.capture_message(f'Workflow failure: {reason}')\n    except Exception as e:\n        logger.debug(f'Failed to capture workflow failure in Sentry: {e}')"
    },
    {
      "name": "capture_api_failure",
      "line": 148,
      "code": "def capture_api_failure(api_name: str, error: Exception, context: Optional[dict]=None):\n    \"\"\"Capture API failure in Sentry.\"\"\"\n    if not _sentry_initialized:\n        return\n    try:\n        import sentry_sdk\n        with sentry_sdk.push_scope() as scope:\n            scope.set_tag('failure_type', 'api')\n            scope.set_tag('api', api_name)\n            scope.set_level('error')\n            if context:\n                for key, value in context.items():\n                    scope.set_context(key, value)\n            sentry_sdk.capture_exception(error)\n    except Exception as e:\n        logger.debug(f'Failed to capture API failure in Sentry: {e}')"
    },
    {
      "name": "capture_data_source_failure",
      "line": 173,
      "code": "def capture_data_source_failure(source: str, symbol: str, error: str):\n    \"\"\"Capture data source failure in Sentry.\"\"\"\n    if not _sentry_initialized:\n        return\n    try:\n        import sentry_sdk\n        with sentry_sdk.push_scope() as scope:\n            scope.set_tag('failure_type', 'data_source')\n            scope.set_tag('source', source)\n            scope.set_tag('symbol', symbol)\n            scope.set_level('warning')\n            sentry_sdk.capture_message(f'Data source failure: {source} failed for {symbol}: {error}')\n    except Exception as e:\n        logger.debug(f'Failed to capture data source failure in Sentry: {e}')"
    }
  ]
}
