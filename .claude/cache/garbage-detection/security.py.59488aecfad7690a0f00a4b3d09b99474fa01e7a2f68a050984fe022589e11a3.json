{
  "dead_imports": [],
  "commented_blocks": [],
  "empty_functions": [],
  "unused_variables": [],
  "all_functions": [
    {
      "name": "mask_api_key",
      "line": 13,
      "code": "def mask_api_key(api_key: Optional[str], visible_chars: int=4) -> str:\n    \"\"\"\n    Mask an API key, showing only the first few characters.\n    \n    Args:\n        api_key: The API key to mask (can be None)\n        visible_chars: Number of characters to show (default: 4)\n    \n    Returns:\n        Masked API key string (e.g., \"ABCD***\" or \"***\" if None)\n    \n    Example:\n        >>> mask_api_key(\"sk-1234567890abcdef\")\n        \"sk-1***\"\n        >>> mask_api_key(None)\n        \"***\"\n    \"\"\"\n    if not api_key:\n        return '***'\n    if len(api_key) <= visible_chars:\n        return '***'\n    return f'{api_key[:visible_chars]}***'"
    },
    {
      "name": "mask_secret",
      "line": 39,
      "code": "def mask_secret(secret: Optional[str], visible_chars: int=4) -> str:\n    \"\"\"\n    Mask a secret key, showing only the first few characters.\n    \n    Args:\n        secret: The secret to mask (can be None)\n        visible_chars: Number of characters to show (default: 4)\n    \n    Returns:\n        Masked secret string (e.g., \"ABCD***\" or \"***\" if None)\n    \"\"\"\n    return mask_api_key(secret, visible_chars)"
    },
    {
      "name": "sanitize_log_message",
      "line": 53,
      "code": "def sanitize_log_message(message: str) -> str:\n    \"\"\"\n    Sanitize a log message by masking any potential API keys or secrets.\n    \n    This function attempts to detect and mask common patterns of API keys\n    and secrets in log messages.\n    \n    Args:\n        message: The log message to sanitize\n    \n    Returns:\n        Sanitized message with sensitive data masked\n    \"\"\"\n    patterns = [('(api[_-]?key[\"\\\\\\']?\\\\s*[:=]\\\\s*[\"\\\\\\']?)([a-zA-Z0-9_-]{10,})([\"\\\\\\']?)', '\\\\1***\\\\3'), ('(secret[\"\\\\\\']?\\\\s*[:=]\\\\s*[\"\\\\\\']?)([a-zA-Z0-9_-]{10,})([\"\\\\\\']?)', '\\\\1***\\\\3'), ('(password[\"\\\\\\']?\\\\s*[:=]\\\\s*[\"\\\\\\']?)([^\\\\s\"\\\\\\']+)([\"\\\\\\']?)', '\\\\1***\\\\3'), ('(token[\"\\\\\\']?\\\\s*[:=]\\\\s*[\"\\\\\\']?)([a-zA-Z0-9_-]{20,})([\"\\\\\\']?)', '\\\\1***\\\\3')]\n    sanitized = message\n    for pattern, replacement in patterns:\n        sanitized = re.sub(pattern, replacement, sanitized, flags=re.IGNORECASE)\n    return sanitized"
    },
    {
      "name": "is_sensitive_key",
      "line": 81,
      "code": "def is_sensitive_key(key_name: str) -> bool:\n    \"\"\"\n    Check if a key name indicates sensitive information.\n    \n    Args:\n        key_name: The name of the key/variable to check\n    \n    Returns:\n        True if the key name suggests sensitive data\n    \"\"\"\n    sensitive_patterns = ['api_key', 'apikey', 'api-key', 'secret', 'secret_key', 'secret-key', 'password', 'passwd', 'pwd', 'token', 'access_token', 'refresh_token', 'auth', 'authorization', 'credential', 'cred']\n    key_lower = key_name.lower()\n    return any((pattern in key_lower for pattern in sensitive_patterns))"
    }
  ]
}
