{
  "dead_imports": [
    {
      "line": 8,
      "module": "annotations",
      "statement": "from __future__ import annotations"
    },
    {
      "line": 12,
      "module": "datetime",
      "statement": "from datetime import date, datetime, timedelta"
    }
  ],
  "commented_blocks": [],
  "empty_functions": [],
  "unused_variables": [
    {
      "line": 23,
      "variable": "BASE_URL"
    },
    {
      "line": 26,
      "variable": "MAJOR_EVENT_TYPES"
    }
  ],
  "all_functions": [
    {
      "name": "__init__",
      "line": 35,
      "code": "def __init__(self, api_key: Optional[str]=None) -> None:\n    self.api_key = api_key or os.getenv('FINNHUB_API_KEY')\n    if not self.api_key:\n        logger.warning('FINNHUB_API_KEY not set. Economic calendar checks will be unavailable.')"
    },
    {
      "name": "get_economic_calendar",
      "line": 42,
      "code": "def get_economic_calendar(self, start_date: Optional[date]=None, end_date: Optional[date]=None) -> List[Dict]:\n    \"\"\"\n        Get economic calendar events for a date range.\n\n        Args:\n            start_date: Start date (defaults to today)\n            end_date: End date (defaults to today)\n\n        Returns:\n            List of economic events\n        \"\"\"\n    if not self.api_key:\n        logger.debug('Finnhub API key not available')\n        return []\n    if start_date is None:\n        start_date = date.today()\n    if end_date is None:\n        end_date = date.today()\n    try:\n        url = f'{self.BASE_URL}/calendar/economic'\n        params = {'token': self.api_key, 'from': start_date.strftime('%Y-%m-%d'), 'to': end_date.strftime('%Y-%m-%d')}\n        response = requests.get(url, params=params, timeout=10)\n        response.raise_for_status()\n        data = response.json()\n        if 'error' in data:\n            error_msg = data.get('error', 'Unknown error')\n            if 'access' in error_msg.lower() or 'permission' in error_msg.lower():\n                logger.warning('Finnhub economic calendar requires premium plan - feature unavailable')\n                return []\n            logger.warning('Finnhub API error: %s', error_msg)\n            return []\n        events = data.get('economicCalendar', [])\n        logger.info('Fetched %d economic events from Finnhub', len(events))\n        return events\n    except Exception as exc:\n        logger.warning('Failed to fetch economic calendar: %s', exc)\n        return []"
    },
    {
      "name": "has_major_event_today",
      "line": 94,
      "code": "def has_major_event_today(self) -> bool:\n    \"\"\"\n        Check if there's a major economic event today.\n\n        Returns:\n            True if major event today, False otherwise\n        \"\"\"\n    if not self.api_key:\n        return False\n    events = self.get_economic_calendar()\n    if not events:\n        return False\n    today_str = date.today().strftime('%Y-%m-%d')\n    for event in events:\n        event_date = event.get('date', '')\n        event_type = event.get('event', '')\n        if event_date.startswith(today_str):\n            for major_type in self.MAJOR_EVENT_TYPES:\n                if major_type.upper() in event_type.upper():\n                    logger.warning('Major economic event today: %s (%s)', event_type, event_date)\n                    return True\n    return False"
    },
    {
      "name": "get_earnings_calendar",
      "line": 127,
      "code": "def get_earnings_calendar(self, start_date: Optional[date]=None, end_date: Optional[date]=None) -> List[Dict]:\n    \"\"\"\n        Get earnings calendar for a date range.\n\n        Args:\n            start_date: Start date (defaults to today)\n            end_date: End date (defaults to today + 7 days)\n\n        Returns:\n            List of earnings announcements\n        \"\"\"\n    if not self.api_key:\n        logger.debug('Finnhub API key not available')\n        return []\n    if start_date is None:\n        start_date = date.today()\n    if end_date is None:\n        end_date = date.today() + timedelta(days=7)\n    try:\n        url = f'{self.BASE_URL}/calendar/earnings'\n        params = {'token': self.api_key, 'from': start_date.strftime('%Y-%m-%d'), 'to': end_date.strftime('%Y-%m-%d')}\n        response = requests.get(url, params=params, timeout=10)\n        response.raise_for_status()\n        data = response.json()\n        earnings = data.get('earningsCalendar', [])\n        logger.info('Fetched %d earnings announcements from Finnhub', len(earnings))\n        return earnings\n    except Exception as exc:\n        logger.warning('Failed to fetch earnings calendar: %s', exc)\n        return []"
    },
    {
      "name": "is_earnings_week",
      "line": 168,
      "code": "def is_earnings_week(self, symbol: Optional[str]=None) -> bool:\n    \"\"\"\n        Check if it's earnings week for a symbol (or any major symbol).\n\n        Args:\n            symbol: Optional symbol to check (if None, checks for major indices)\n\n        Returns:\n            True if earnings week, False otherwise\n        \"\"\"\n    if not self.api_key:\n        return False\n    earnings = self.get_earnings_calendar(start_date=date.today(), end_date=date.today() + timedelta(days=7))\n    if symbol:\n        symbol_upper = symbol.upper()\n        for earning in earnings:\n            if earning.get('symbol', '').upper() == symbol_upper:\n                return True\n    else:\n        major_symbols = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'NVDA', 'META', 'TSLA']\n        for earning in earnings:\n            earning_symbol = earning.get('symbol', '').upper()\n            if earning_symbol in major_symbols:\n                logger.info('Earnings week detected for %s', earning_symbol)\n                return True\n    return False"
    }
  ]
}
